<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymleaf.org">

<head>
    <div th:replace="~{fragments/headApp :: head}"></div>
    <script type="text/javascript" th:src="@{/js/main.js}"></script>
    <link th:href="@{/css/main.css}" rel="stylesheet"/>
</head>
<body>
<div th:replace="~{fragments/navbarApp :: navigation}"></div>
<div class="text">
    <div class="hello">
        <br><br>

        <div class="container-fluid hello" style="">
            <div class="">
            <span class="my-4">
              <h4>
                Lista obecności
                <a href="#" class="">
                  <i style="font-size: 0.7em" class="bx bxs-info-circle info"> </i
                  ></a>
              </h4>
            </span>
                <hr/>

                <div id="day-form" class="form-inline my-0 my-lg-0" style="font-size: 0.9em;">
                    <!--                    <form lang="pl" class="form-inline my-0 my-lg-0">-->
<!--                    <label for="group" style="font-weight: bold"></label>-->
                    <input
                            class="form-control my-1 mr-sm-2"
                            type="search"
                            placeholder="Imie"
                            aria-label="Search"
                    />
                    <input
                            class="form-control mr-sm-2"
                            type="search"
                            placeholder="Nazwisko"
                            aria-label="Search"
                    />
                    <div class="md-form mb-0 m-1 form-group form-field">
                        <select id="selected-item-list" onchange="getUsersByGroupsId(this)"
                                class="form-control select-input mr-sm-2" name="groupId">
                            <option selected name="groupId" value="all">Wszystkie grupy</option>
                            <option name="groupId" value="none">Brak grupy</option>
                            <option th:each="team : ${teams}"
                                    th:value="${team.idTeam}"
                                    th:text="${team.teamName}"
                            ></option>
                        </select>
                    </div>
                    <input
                            onchange="getUsersByDate(this)"
                            style = " min-width: 170px"
                            type="date"
                            lang="fr-CA"
                            data-date=""
                            id="id-date-group"
                            data-date-format="DD MMMM YYYY"
                    />
                    <script type="text/javascript">
                        // window.onload = dataChange();
                    </script>
                    <div class="form-group"></div>
                    <button
                            class="btn btn-outline-success my-2 my-sm-0 form-control"
                            type="submit">
                        Wyszukaj po kilku frazach
                    </button>
                    <!--                    </form>-->
                </div>
                <script src="main.js"></script>
            </div>
        </div>
        <div class="container-fluid">
            <div class="col-lg-6">
                <button
                        class="navigation-card-button"
                        onclick="getUsersByGroupsId('all');changePanel('attendanceList')"
                        type="submit"
                >
                    Lista użytkowników
                </button>
                <button
                        class="navigation-card-button"
                        onclick="changePanel('user-add')"
                        type="submit"
                >
                    Dodaj użytkownika
                </button>
                <button
                        class="navigation-card-button"
                        onclick="changePanel('group-add')"
                        type="submit"
                >
                    Konkretne miesiące
                </button>
                <button
                        class="navigation-card-button"
                        onclick="changePanel('group-add')"
                        type="submit"
                >
                    Statystyki
                </button>
            </div>
        </div>

    </div>
</div>

<section id="attendanceList" class="container-fluid container-custom  right-panel  text-center scrollit">
    <table style="padding: 5px" class="table ">
        <thead>
        <tr>
            <th class="colth" style="" scope="col"></th>
            <th class="colth" scope="col">Imię</th>
            <th class="colth" scope="col">Nazwisko</th>
            <th class="colth" scope="col">Grupa</th>
            <th class="colth" scope="col">Rozliczenie</th>
            <th class="colth" scope="col">Email</th>
            <th class="colth" scope="col">Telefon</th>
            <th class="colth" scope="col">Data zapisu</th>
            <th class="colth" scope="col">Opcje</th>
            <!-- <th scope="col"> Info.</th> -->
        </tr>
        </thead>
        <tbody id="tbody-element">
        </tbody>


    </table>
    <button
            class="navigation-card-button"
            onclick="savePresence()"
            type="submit">
        Zapisz obecności
    </button>
</section>

<div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="inside-modal ">
            <div class="text">
                <div class="hello">
                    <form class="form-inline my-2 my-lg-0">
                        <input class="form-control mr-sm-2 my-2" type="search" placeholder="Imie"
                               aria-label="Search">
                        <input class="form-control mr-sm-2" type="search" placeholder="Nazwisko"
                               aria-label="Search">
                        <input class="form-control mr-sm-2 my-2" type="search" placeholder="Wiek"
                               aria-label="Search">
                        <input class="form-control mr-sm-2" type="search" placeholder="Numer indywidualny"
                               aria-label="Search">

                        <input class="form-control mr-sm-2 my-2" type="email" name="email" placeholder="E-mail">
                        <input class="form-control mr-sm-2 my-2" type="tel" id="phone" name="phone"
                               placeholder="Numer telefonu">
                        <input class="form-control mr-sm-2 my-2" type="tel" id="phone" name="phone"
                               placeholder="Rozliczenie na ten cykl">

                        <select class="form-control mr-sm-2 my-2" name="offer"
                                aria-label="Default select example">
                            <option name="FIFTY" value="FIFTY" selected>Grupa 1</option>
                            <option name="HUNDRED" value="HUNDRED" selected>Grupa 2</option>
                            <option name="TWO_HUNDRED" value="TWO_HUNDRED" selected>Grupa 2</option>
                            <option name="FIVE_HUNDRED" value="FIVE_HUNDRED" selected>Grupa 2</option>
                        </select>
                        <div class="container" style="font-size: 0.8em; text-align:left!important">
                            <input type="checkbox" id="scales" name="scales" class="option"/> Cena indywdualna

                        </div>
                        <select class="form-control mr-sm-2 my-2" name="offer"
                                aria-label="Default select example">
                            <option name="FIFTY" value="FIFTY" selected>Karnet rodzina 2-os.</option>
                            <option name="HUNDRED" value="HUNDRED" selected>Karnet rodzina 2-os.</option>
                            <option name="TWO_HUNDRED" value="TWO_HUNDRED" selected>Karnet rodzina 2-os.
                            </option>
                            <option name="FIVE_HUNDRED" value="FIVE_HUNDRED" selected>Karnet rodzina 2-os.
                            </option>
                        </select>
                        <input class="form-control mr-sm-2 my-2" type="tel" id="phone" name="phone"
                               placeholder="Cena">
                        <div style="font-size: 0.8em; text-align:left!important"> Cykl rozliczeniowy</div>
                        <select class="form-control mr-sm-2 my-2 " name="offer"
                                aria-label="Default select example">
                            <option name="FIFTY" value="FIFTY" selected>Co zajęcia.</option>
                            <option name="HUNDRED" value="HUNDRED" selected>1 tyg.</option>
                            <option name="FIFTY" value="FIFTY" selected>2 tyg.</option>
                            <option name="HUNDRED" value="HUNDRED" selected>1 msc.</option>
                            <option name="HUNDRED" value="HUNDRED" selected>2 msc.</option>
                            <option name="TWO_HUNDRED" value="TWO_HUNDRED" selected>3 msc.</option>
                            <option name="FIVE_HUNDRED" value="FIVE_HUNDRED" selected>6 msc.</option>
                            <option name="FIVE_HUNDRED" value="FIVE_HUNDRED" selected>12 msc.</option>
                        </select>

                        <div style="font-size: 0.8em; text-align:left!important">
                            Data zapisu<br> <input type="date" lang="fr-CA" class="my-2" data-date=""
                                                   id="date-picker" data-date-format="DD MMMM YYYY"><br>
                            Data pierwszej wpłaty <br><input type="date" class="my-2" lang="fr-CA" data-date=""
                                                             id="date-picker"
                                                             data-date-format="DD MMMM YYYY"><br>
                            Data kolejnej wpłaty <br><input type="date" class="my-2" lang="fr-CA" data-date=""
                                                            id="date-picker"
                                                            data-date-format="DD MMMM YYYY"><br>
                        </div>
                        <script type="text/javascript">

                            window.onload = dataChange();
                        </script>
                        <br>
                        <a href="#"> <i class='bx bxs-edit-alt success'><span> Zapisz</span></i></a>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<section id="user-add" style="display: none">
    <div class="container text-center">
        <div class="row" style="">
            <div class="col-lg-6 right-panel">
                <!--                <form class="login-form" th:action="@{/app/postUser}" method="POST">-->
                <select id="select-teams" onchange="moreInformation(this)" class="form-control select-input mr-sm-2"
                        name="groupId">
                    <option selected name="groupId" value="">Wybierz grupe</option>
                    <option th:each="team : ${teams}"
                            th:value="${team.idTeam}"
                            th:text="${team.teamName}"
                    ></option>
                </select>
                <div class="my-2" id="prices-div">
                </div>
                </hr>
                <input
                        hidden
                        class="form-control "
                        type="text"
                        id="user-id"
                        name="userId"
                />
                <input
                        class="form-control my-3"
                        type="text"
                        id="user-name"
                        name="userName"
                        placeholder="Imię *"
                />
                <input
                        class="form-control my-3"
                        type="text"
                        id="user-surname"
                        name="userSurname"
                        placeholder="Nazwisko *"
                />
                <input
                        class="form-control my-3"
                        type="text"
                        id="user-phone"
                        name="userPhone"
                        placeholder="Numer telefonu"
                />
                <input
                        class="form-control my-3"
                        type="text"
                        id="user-email"
                        name="userEmail"
                        placeholder="Email "
                />

                <input id="user-of-age" style="width: 20px !important;" type="checkbox" name="userOfAge"/>
                <b style="font-size: 0.7em"> Jestem pełnoletni/nia </b>
                <div style="display:none;float: left;" class="my-2" id="prices-ul">
                </div>
                <div id="term">
                    <div id="part-term" style="display: flex"></div>
                </div>
                <hr/>
                <button id="button-save-user" class="btn btn-outline-success w-100"
                        onclick="addUser(); removeId('group-id')"
                        type="submit">
                    Zapisz
                </button>
                <!--                </form>-->
            </div>
            <div class="col-lg-6 right-panel">
                <ul style="font-size: 0.7em"
                    class="list-group list-unstyled list-group-flush">
                    <li id="li-group-info-groupName" style="display: none" class="my-2 group-info ">
                        <div><b>Nazwa grupy: </b>
                            <span id="span-group-info-groupName"></span>
                        </div>
                    </li>
                    <li id="li-group-info-leaderName" style="display: none" class="my-2 group-info ">
                        <div><b>Prowadzący: </b>
                            <span id="span-group-info-leaderName"></span>
                        </div>
                    </li>
                    <li id="li-group-info-place" style="display: none" class="my-2 group-info ">
                        <div><b>Lokalizacja: </b>
                            <span id="span-group-info-place"></span>
                        </div>
                    </li>
                    <li id="li-group-info-terms" style="display: none" class="my-2 group-info ">
                        <div><b>Terminy: </b>
                            <span id="span-group-info-terms"></span>
                        </div>
                    </li>
                    <li id="li-group-info-space" style="display: none" class="my-2 group-info ">
                        <div><b>Wolne miejsca: </b>
                            <span id="span-group-info-space"></span>
                        </div>
                    </li>
                    <li id="li-group-info-data" style="display: none" class="my-2 group-info ">
                        <div><b>Od kiedy: </b>
                            <span id="span-group-info-data"></span>
                        </div>
                    </li>
                    <li id="li-group-info-firstFree" style="display: none" class="my-2 group-info ">
                        <div><b>Pierwsze zajecia darmowe: </b>
                            <span id="span-group-info-firstFree"></span>
                        </div>
                    </li>
                    <li id="li-group-info-description" style="display: none" class="my-2 group-info ">
                        <div><b>Dodatkowa informacja: </b>
                            <span id="span-group-info-description"></span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>
<section id="modals">
</section>

<section id="specific-months" style="display: none">
</section>
<input id="temporary-value" hidden type="text" value="all"/>

<script>
    function changePriceStatus(element, temp) {
        if (element.innerText === "0") {
            element.innerText = temp;
        } else {
            element.innerText = "0";
        }
    }

    function showOrHidePrices(option, className) {
        let elementsPrices = document.getElementsByClassName(className);
        for (var i = 0; i < elementsPrices.length; i++) {
            elementsPrices[i].style.display = option;
        }
    }

    function addUser() {
        var xhr = new XMLHttpRequest();

        let userId = document.getElementById("user-id");
        var selectGroup = document.getElementById("select-teams");
        var selectedOptionGroupId = selectGroup.value;
        let userName = document.getElementById("user-name").value;
        let userSurname = document.getElementById("user-surname").value;
        let userPhone = document.getElementById("user-phone").value;
        let userEmail = document.getElementById("user-email").value;
        let userOfAge = document.getElementById('user-of-age').checked;

        var prices = document.getElementsByName('priceId');
        var pricesId;
        for (var i = 0; i < prices.length; i++) {
            if (prices[i].checked) {
                pricesId = prices[i].value;
            }
        }

        xhr.open('POST', "/app/postUser?groupId=" + selectedOptionGroupId +
            "&priceId=" + pricesId +
            "&userName=" + userName +
            "&userSurname=" + userSurname +
            "&userPhone=" + userPhone +
            "&userEmail=" + userEmail +
            "&userOfAge=" + userOfAge, true);

        xhr.send('');

        xhr.onreadystatechange = function () {
            var users;
            if (this.readyState === 4 && this.status === 200) {
                // users = JSON.parse(xhr.responseText);
                // console.log(users);
                moreInformation("noOption");
                clearingInputsAddUser();
                // getUsers(selectedOptionGroupId);
            }
        }
    }

    function clearingInputsAddUser() {
        document.getElementById("user-name").value = "";
        document.getElementById("user-surname").value = "";
        document.getElementById("user-phone").value = "";
        document.getElementById("user-email").value = "";
        document.getElementById('user-of-age').checked = "";
        document.getElementById("select-teams").selectedIndex = 0;
    }

    function getUsersByGroupsId(event) {
        var xhr = new XMLHttpRequest();
        var groupId = "";

        groupId = event.value;
        if (groupId === undefined) {
            groupId = event;
        }

        xhr.open('GET', "/app/getUsersByGroupsId?groupId=" + groupId, true);
        xhr.send('');

        xhr.onreadystatechange = function () {
            var users;
            if (this.readyState === 4 && this.status === 200) {
                users = JSON.parse(xhr.responseText);
                generateTable(users);
            }
        }
    }

    function generateTable(user) {
        var result = "";

        for (let i = 0; i < user.length; i++) {
            var modal = "exampleModalPrice" + user[i]['idUser'];

            var modalLabel = "exampleModalLabelPrice" + user[i]['idUser'];

            var idUser = user[i]['idUser'];
            var name = "'" + user[i]['name'] + "'";
            var surname = "'" + user[i]['surname'] + "'";
            var email = "'" + user[i]['email'] + "'";
            var phone = user[i]['phone'];
            var dateOfRecording = "'" + user[i]['dateOfRecording'] + "'";
            var teamName = "'" + user[i]['teams']['teamName'] + "'";
            var individualPriceId = user[i]['individualPriceId'];
            var individualPriceName = "'" + user[i]['individualPriceName'] + "'";
            var individualPriceValue = user[i]['individualPriceValue'];
            var individualPriceCycle = user[i]['individualPriceCycle'];
            var individualPriceDesc = "'" + user[i]['individualPriceDesc'] + "'";
            var currentPaymentDate = "'" + user[i]['currentPaymentDate'] + "'";
            var nextPaymentDate = "'" + user[i]['nextPaymentDate'] + "'";

            result = result
                +
                '<tr style=""> ' +
                '<td scope="row">' +
                '<input style="width: 20px !important;" type="checkbox"  th:name="userId"  value="' + user[i]['idUser'] + '" class="optionUserInput"/>' +
                '</td>' +
                '<td id="table-user-name">' + user[i]['name'] + '</td>' +
                '<td id="table-user-surname">' + user[i]['surname'] + '</td>' +
                '<td id="table-user-groupName">' + user[i]['teams']['teamName'] + '</td>' +
                '<td id="table-user-settlement">' +
                '<Button class="price" onclick="changePriceStatus(this,' + user[i]['individualPriceValue'] + ')">' + user[i]['individualPriceValue'] + '</Button>' +
                '</td>' +
                '<td id="table-user-email">' + user[i]['email'] + '</td>' +
                '<td id="table-user-phone">' + user[i]['phone'] + '</td>' +
                '<td id="table-user-dataOfRecording">' + user[i]['dateOfRecording'] + '</td>' +
                '<td data-label="info.">' +
                '<Button type="button" class="option-card-button" onclick="editUser(' + name + ',' + surname + ',' + individualPriceId + ',' + individualPriceName + ',' + individualPriceValue + ',' + individualPriceCycle + ',' + individualPriceDesc + ',' + currentPaymentDate + ',' + nextPaymentDate + ',' + teamName + ',' + dateOfRecording + ',' + email + ',' + phone + ',' + idUser + ')">Edytuj</Button>&nbsp;' +
                '<Button  class="option-card-button" data-toggle="modal" data-target="#' + modal + '" >Usuń</Button>' +
                '</td>' +
                ' <div class="modal fade" id="' + modal + '" tabindex="-1" role="dialog" aria-labelledby="' + modalLabel + '" aria-hidden="true">\n' +
                '     <div class="modal-dialog" role="document">\n' +
                '         <div class="modal-content">\n' +
                '             <div class="modal-header">\n' +
                '                 <h5 class="modal-title" id="' + modalLabel + '">Usuwanie uczestnika</h5>\n' +
                '                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n' +
                '                     <span aria-hidden="true">&times;</span>\n' +
                '                 </button>\n' +
                '             </div>\n' +
                '             <div class="modal-body">\n' +
                '                 Czy napewno chcesz usunąć uczestnika?\n' +
                '             </div>\n' +
                '             <div class="modal-footer">\n' +
                '                 <button id="button-delete-price" class="option-card-button btnShow" data-dismiss="modal" style="font-size: 0.9em!important;  min-width: 75px!important; height: auto!important"\n' +
                '                         onclick="deleteUser(' + user[i]['teams']['idTeam'] + ',' + user[i]['idUser'] + ')">Tak</button>\n' +
                '                 <button type="button" class="option-card-button" style="font-size: 1em!important; min-width: 100px!important; height: auto!important" data-dismiss="modal">Anuluj</button>\n' +
                '             </div>\n' +
                '         </div>\n' +
                '     </div>\n' +
                ' </div>' +
                '</tr>';

        }
        document.getElementById("tbody-element").innerHTML = result;
    }

    function generateEditModal(name, surname, individualPriceId, individualPriceName, individualPriceValue,
                               individualPriceCycle, individualPriceDesc, currentPaymentDate, nextPaymentDate,
                               teamName, dateOfRecording, email, phone, idUser, teamsPrices) {

        var modalEdit = "exampleModalPriceEdit" + idUser;
        var modalLabelEdit = "exampleModalLabelPriceEdit" + idUser;

        var userIdentifier = "user-edit-identifier";
        userIdentifier = "'" + userIdentifier + "'";
        var userClasses = "user-edit-classes";
        userClasses = "'" + userClasses + "'";

        var options = '<option  name="groupId" value="">Zmień grupę</option>';
        for (let i = 0; i < teamsPrices.length; i++) {

                options = options + '<option style="color: #1e1c35" value="' + teamsPrices[i]['team']['idTeam'] + '">' + teamsPrices[i]['team']['teamName'] + '</option>';
        }

        var result =

            '<Button  id="editButton" hidden  class="option-card-button" data-toggle="modal" data-target="#' + modalEdit + '" >Usuń</Button>' +
            '<div class="modal fade" id="' + modalEdit + '" tabindex="-1" role="dialog" aria-labelledby="' + modalLabelEdit + '" aria-hidden="true">\n' +
            '     <div class="modal-dialog" role="document">\n' +
            '         <div class="modal-content">\n' +
            '             <div class="modal-header">\n' +
            '                 <h5 class="modal-title" id="' + modalLabelEdit + '">Edytowanie uczestnika</h5>\n' +
            '                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n' +
            '                     <span aria-hidden="true">&times;</span>\n' +
            '                 </button>\n' +
            '             </div>\n' +
            '             <div id="modal-body-edit' + idUser + '" class="modal-body">\n' +
            '                   <input hidden value="' + idUser + '" class="form-control my-1 mr-sm-2" />' +
            '                   <input hidden value="' + individualPriceId + '" class="form-control my-1 mr-sm-2" />' +
            '                   <input value="' + name + '" class="form-control my-1 mr-sm-2" placeholder="Imie"/>' +
            '                   <input value="' + surname + '" class="form-control my-1 mr-sm-2" placeholder="Nazwisko"/>' +
            '                   <input disabled value="' + teamName + '" class="form-control my-1 mr-sm-2" placeholder="Nazwa grupy"/>' +
            '                   <select onchange="moreInformationForEdit(this,' + userIdentifier + ',' + userClasses + ');" class="form-control select-input mr-sm-2 ' + userClasses + '" name="groupId">' + options + '</select>' +
            '                   <div id="user-edit-identifier"  class="my-2"></div>' +
            '                   <input value="' + individualPriceCycle + '" class="form-control my-1 mr-sm-2" placeholder="Cykl rozliczeniowy"/>' +
            '                   <span style="font-size: 0.7em"> Data wpłaty od i do </span> ' +
            '                   <input value="' + currentPaymentDate + '" class="form-control my-2" type="date" id="" name="" placeholder=""/>' +
            '                   <input value="' + nextPaymentDate + '" class="form-control my-2" type="date" id="" name="" placeholder=""/>' +
            '                   <input value="' + individualPriceValue + '" class="form-control my-1 mr-sm-2" placeholder="Rozliczenie"/>' +
            '                   <input value="' + email + '" class="form-control my-1 mr-sm-2" placeholder="Email"/>' +
            '                   <input value="' + phone + '" class="form-control my-1 mr-sm-2" placeholder="Telefon"/>' +
            '                   <input value="' + dateOfRecording + '" class="form-control my-1 mr-sm-2" placeholder="Data zapisu"/>' +
            '             </div>\n' +
            '             <div class="modal-footer">\n' +
            '                 <button id="button-delete-price" class="option-card-button btnShow" data-dismiss="modal" style="font-size: 0.9em!important;  min-width: 75px!important; height: auto!important"\n' +
            '                         onclick="">Edytuj</button>\n' +
            '                 <button type="button" class="option-card-button" style="font-size: 0.9em!important; min-width: 75px!important; height: auto!important" data-dismiss="modal">Anuluj</button>\n' +
            '             </div>\n' +
            '         </div>\n' +
            '     </div>\n' +
            ' </div>';

        document.getElementById("modals").innerHTML = result;
        document.getElementById("editButton").click();
    }

    function deleteUser(idTeam, idUser) {

        var xhr = new XMLHttpRequest();

        xhr.open('POST', "/app/deleteUser?groupId=" + idTeam + "&userId=" + idUser, true);
        xhr.send('');

        xhr.onreadystatechange = function () {
            if (this.readyState === 4 && this.status === 200) {
                var selectGroup = document.getElementById("selected-item-list");
                var selectedOptionGroupId = selectGroup.value;
                getUsersByGroupsId(selectedOptionGroupId);
            }
        }
    }

    function moreInformation(event) {
        if (event.value === "" || event === "noOption") {
            let elementsGroup = document.getElementsByClassName("group-info");
            for (var i = 0; i < elementsGroup.length; i++) {
                elementsGroup[i].style.display = "none";
            }
            showOrHidePrices("none", "part-prices");
        } else {
            var xhr = new XMLHttpRequest();
            var groupId = event.value;
            xhr.open('GET', "/app/getSpecifiedGroupInformation?groupId=" + groupId, true);
            xhr.send('');
            xhr.onreadystatechange = function () {
                var issue;
                if (this.readyState === 4 && this.status === 200) {
                    issue = JSON.parse(xhr.responseText);
                    generatedDivPricesForGroups(issue['prices']);
                    generatedGroupInfo(issue['teams'], issue['terms']);
                }
            }
        }
    }

    function moreInformationForEdit(event, ids, classes) {

        var groupId = "";
        if (event.value === "" || event === "noOption") {
            let elementsGroup = document.getElementsByClassName("group-info");
            for (var i = 0; i < elementsGroup.length; i++) {
                elementsGroup[i].style.display = "none";
            }
        }
        else {
            groupId = event.value;

            var xhr = new XMLHttpRequest();

            xhr.open('GET', "/app/getSpecifiedGroupInformation?groupId=" + groupId, true);
            xhr.send('');

            xhr.onreadystatechange = function () {
                var prices;
                if (this.readyState === 4 && this.status === 200) {
                    prices = JSON.parse(xhr.responseText);
                    generatedDivPricesForEdit(prices, ids, classes);
                }
            }
        }
    }

    function generatedDivPricesForEdit(prices, ids, classes) {

        var result = "";
        for (let i = 0; i < prices['prices'].length; i++) {

            console.log(prices['prices'][i]['idPrice']);
            result = result
                +
                '<div class="' + classes + '" style="display: flex;color:black; font-size:0.6em!important">\n' +
                '<input style="width: 20px !important;" type="radio"   value="' + prices['prices'][i]['idPrice'] + '" name="priceId"/>\n' +
                ' <b>' + "Nazwa:&nbsp;" + '</b>' + prices['prices'][i]['name'] + ", &nbsp;" +
                ' <b>' + "Cena:&nbsp;" + '</b>' + prices['prices'][i]['value'] + "zł, &nbsp;" +
                ' <b>' + "Rozliczenie:&nbsp;" + '</b>' + prices['prices'][i]['cycle'] + "dni, &nbsp;" +
                ' <b>' + "Opis:&nbsp;" + '</b>' + prices['prices'][i]['description'];
                '</div>';
        }

        document.getElementById(ids).innerHTML = result;
        showOrHidePrices("block", "part-prices-edit");
    }

    function editUser(name, surname, individualPriceId, individualPriceName, individualPriceValue, individualPriceCycle, individualPriceDesc, currentPaymentDate, nextPaymentDate, teamName, dateOfRecording, email, phone, idUser) {

        var xhr = new XMLHttpRequest();

        xhr.open('GET', "/app/getTeamsAndPrices", true);
        xhr.send('');

        xhr.onreadystatechange = function () {
            var teamsPrices;
            if (this.readyState === 4 && this.status === 200) {
                teamsPrices = JSON.parse(xhr.responseText);
                generateEditModal(name, surname, individualPriceId, individualPriceName, individualPriceValue,
                    individualPriceCycle, individualPriceDesc, currentPaymentDate, nextPaymentDate,
                    teamName, dateOfRecording, email, phone, idUser, teamsPrices);
            }
        }

    }

    function generatedDivPricesForGroups(prices) {

        var result = "";
        for (let i = 0; i < prices.length; i++) {
            result = result
                +
                '<div class="part-prices" style="display: flex;color:black; font-size:0.6em!important">\n' +
                '<input style="width: 20px !important;" type="radio"   value="' + prices[i]['idPrice'] + '" name="priceId"/>\n' +
                ' <b>' + "Nazwa:&nbsp;" + '</b>' + prices[i]['name'] + ", &nbsp;" +
                ' <b>' + "Cena:&nbsp;" + '</b>' + prices[i]['value'] + "zł, &nbsp;" +
                ' <b>' + "Rozliczenie:&nbsp;" + '</b>' + prices[i]['cycle'] + "dni, &nbsp;" +
                ' <b>' + "Opis:&nbsp;" + '</b>' + prices[i]['description'] +
                "</div>";
        }

        document.getElementById("prices-div").innerHTML = result;
        showOrHidePrices("block", "part-prices");
    }

    function generatedGroupInfo(team, terms) {

        let idTeam = team['idTeam'];
        let teamName = team['teamName'];
        let leaderName = team['leaderName'];
        let place = team['place'];
        let startDate = team['startDate'];
        let endDate = team['endDate'];
        let freeSpace = team['freeSpace'];
        let groupSize = team['groupSize'];
        let firstFree = team['firstFree'];
        let description = team['description'];
        let displayTerms = "";
        for (let i = 0; i < terms.length; i++) {
            displayTerms = displayTerms + terms[i] + ", ";

        }
        let data = "";

        if (endDate !== "") {
            data = startDate + " do " + endDate;
        } else {
            data = startDate;
        }

        let li_group_name = document.getElementById('li-group-info-groupName');
        let span_group_name = document.getElementById('span-group-info-groupName');

        let li_leader_name = document.getElementById('li-group-info-leaderName');
        let span_leader_name = document.getElementById('span-group-info-leaderName');

        let li_place = document.getElementById('li-group-info-place');
        let span_place = document.getElementById('span-group-info-place');

        let li_terms = document.getElementById('li-group-info-terms');
        let span_terms = document.getElementById('span-group-info-terms');

        let li_space = document.getElementById('li-group-info-space');
        let span_space = document.getElementById('span-group-info-space');

        let li_data = document.getElementById('li-group-info-data');
        let span_data = document.getElementById('span-group-info-data');

        let li_first_free = document.getElementById('li-group-info-firstFree');
        let span_first_free = document.getElementById('span-group-info-firstFree');

        let li_description = document.getElementById('li-group-info-description');
        let span_description = document.getElementById('span-group-info-description');

        if (teamName !== "") {
            span_group_name.innerText = teamName;
            li_group_name.style.display = "block";
        } else {
            li_group_name.style.display = "none";
        }
        if (leaderName !== "") {
            span_leader_name.innerText = leaderName;
            li_leader_name.style.display = "block";
        } else {
            li_leader_name.style.display = "none";
        }
        if (startDate !== "") {
            span_data.innerText = data;
            li_data.style.display = "block";
        } else {
            li_data.style.display = "none";
        }
        if (displayTerms !== "") {
            span_terms.innerText = displayTerms;
            li_terms.style.display = "block";
        } else {
            li_terms.style.display = "none";
        }
        if (groupSize !== "") {
            span_space.innerText = freeSpace + "/" + groupSize;
            li_space.style.display = "block";
        } else {
            li_space.style.display = "none";
        }
        if (place !== "") {
            span_place.innerText = place;
            li_place.style.display = "block";
        } else {
            li_place.style.display = "none";
        }
        if (firstFree !== "true") {
            span_first_free.innerText = "Tak";
            li_first_free.style.display = "block";
        } else {
            li_first_free.style.display = "none";
        }
        if (description !== "") {
            span_description.innerText = description;
            li_description.style.display = "block";
        } else {
            li_description.style.display = "none";
        }
    }

    // Get the modal
    var modal = document.getElementById("myModal");

    // Get the button that opens the modal
    var btn = document.getElementById("myBtn");

    var span = document.getElementsByClassName("close")[0];

    span.onclick = function () {
        modal.style.display = "none";
    }

    window.onload = function () {
        let all = document.getElementById('temporary-value');
        getUsersByGroupsId(all);
    };

    function changePanel(element) {
        var attendanceList = document.getElementById("attendanceList");
        var user_add = document.getElementById("user-add");
        var specific_months = document.getElementById("specific-months");
        if (element === "attendanceList") {
            user_add.style.display = "none";
            attendanceList.style.display = "block";
            specific_months.style.display = "none";
            return;
        }
        if (element === "user-add") {
            user_add.style.display = "block";
            attendanceList.style.display = "none";
            specific_months.style.display = "none";

        }

        if (element === "specific_months") {
            attendanceList.style.display = "none";
            attendanceList.style.display = "none";
            specific_months.style.display = "block";

        }
    }

    function savePresence(){
        // TODO ZAPISYWA OBECNYCH I NIE OBECNYCH CZYLI POBIERAC ID OBECNYCH I NIE OBVECNYCH NA KJONKRETNA DATE

        let date = document.getElementById("id-date-group").value;

        var checkedValue = "";
        var allValue = "";
        var checkedValueOptions = document.getElementsByClassName('optionUserInput');
        var allValueOptions = document.getElementsByClassName('optionUserInput');

        for (let i = 0; i < allValueOptions.length; i++) {
            allValue = allValue + " " + allValueOptions[i].value;

        }

        for(var i=0; checkedValueOptions[i]; ++i){
            if(checkedValueOptions[i].checked){
                checkedValue = checkedValue + " " + checkedValueOptions[i].value;

            }
        }

        var xhr = new XMLHttpRequest();

        xhr.open('POST', "/app/postPresences?checkedValue="  + checkedValue + "&allValue=" + allValue + "&date=" + date, true);
        xhr.send('');

        xhr.onreadystatechange = function () {
            var presences;
            if (this.readyState === 4 && this.status === 200) {
                presences = JSON.parse(xhr.responseText);
                // generateTable(presences);
            }
        }


    }

    function getUsersByDate(element){
        var xhr = new XMLHttpRequest();
        var date = "";

        date = element.value;


        xhr.open('GET', "/app/getUsersByDate?date=" + date, true);
        xhr.send('');

        xhr.onreadystatechange = function () {
            var users;
            if (this.readyState === 4 && this.status === 200) {
                users = JSON.parse(xhr.responseText);
                generateTable(users);
            }
        }
    }

</script>
</body>
</html>